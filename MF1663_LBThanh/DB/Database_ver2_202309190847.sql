--
-- Script was generated by Devart dbForge Studio 2020 for MySQL, Version 9.0.338.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 9/19/2023 8:47:13 AM
-- Server version: 8.0.33
-- Client version: 4.1
--

-- 
-- Disable foreign keys
-- 
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Set default database
--
USE hcsn;

--
-- Drop procedure `Proc_FilterAsset`
--
DROP PROCEDURE IF EXISTS Proc_FilterAsset;

--
-- Drop procedure `Proc_FilterFixedAssetForTransfer`
--
DROP PROCEDURE IF EXISTS Proc_FilterFixedAssetForTransfer;

--
-- Drop procedure `Proc_GetAllFixedAssetFilter`
--
DROP PROCEDURE IF EXISTS Proc_GetAllFixedAssetFilter;

--
-- Drop procedure `Proc_GetAllTransferAssetOfAsset`
--
DROP PROCEDURE IF EXISTS Proc_GetAllTransferAssetOfAsset;

--
-- Drop procedure `Proc_GetFixedAssetPaging`
--
DROP PROCEDURE IF EXISTS Proc_GetFixedAssetPaging;

--
-- Drop procedure `Proc_GetFixedAssetTransferPaging`
--
DROP PROCEDURE IF EXISTS Proc_GetFixedAssetTransferPaging;

--
-- Drop procedure `Proc_GetNewestTransferAssetByAssetId`
--
DROP PROCEDURE IF EXISTS Proc_GetNewestTransferAssetByAssetId;

--
-- Drop procedure `Proc_GetTransferDetaiByAssetId`
--
DROP PROCEDURE IF EXISTS Proc_GetTransferDetaiByAssetId;

--
-- Drop procedure `GetAllReceiver`
--
DROP PROCEDURE IF EXISTS GetAllReceiver;

--
-- Drop table `receiver`
--
DROP TABLE IF EXISTS receiver;

--
-- Drop view `view_transfer_asset_detail`
--
DROP VIEW IF EXISTS view_transfer_asset_detail CASCADE;

--
-- Drop table `transferassetdetail`
--
DROP TABLE IF EXISTS transferassetdetail;

--
-- Drop procedure `Proc_TransferAssetPaging`
--
DROP PROCEDURE IF EXISTS Proc_TransferAssetPaging;

--
-- Drop procedure `TransferAsset_Create`
--
DROP PROCEDURE IF EXISTS TransferAsset_Create;

--
-- Drop procedure `TransferAssetUpdate`
--
DROP PROCEDURE IF EXISTS TransferAssetUpdate;

--
-- Drop procedure `Proc_GetNewTransferAssetCode`
--
DROP PROCEDURE IF EXISTS Proc_GetNewTransferAssetCode;

--
-- Drop function `Func_GetNewTransferAssetCode`
--
DROP FUNCTION IF EXISTS Func_GetNewTransferAssetCode;

--
-- Drop table `transferasset`
--
DROP TABLE IF EXISTS transferasset;

--
-- Drop view `view_fixed_asset`
--
DROP VIEW IF EXISTS view_fixed_asset CASCADE;

--
-- Drop view `view_fixed_asset_category`
--
DROP VIEW IF EXISTS view_fixed_asset_category CASCADE;

--
-- Drop procedure `FixedAsset_Create`
--
DROP PROCEDURE IF EXISTS FixedAsset_Create;

--
-- Drop procedure `FixedAssetUpdate`
--
DROP PROCEDURE IF EXISTS FixedAssetUpdate;

--
-- Drop procedure `GetAllFixedAsset`
--
DROP PROCEDURE IF EXISTS GetAllFixedAsset;

--
-- Drop procedure `Proc_GetNewFixedAssetCode`
--
DROP PROCEDURE IF EXISTS Proc_GetNewFixedAssetCode;

--
-- Drop function `Func_GetNewFixedAssetCode`
--
DROP FUNCTION IF EXISTS Func_GetNewFixedAssetCode;

--
-- Drop table `fixedasset`
--
DROP TABLE IF EXISTS fixedasset;

--
-- Drop procedure `GetAllDepartment`
--
DROP PROCEDURE IF EXISTS GetAllDepartment;

--
-- Drop table `department`
--
DROP TABLE IF EXISTS department;

--
-- Drop procedure `GetAllFixedAssetCategory`
--
DROP PROCEDURE IF EXISTS GetAllFixedAssetCategory;

--
-- Drop table `fixedassetcategory`
--
DROP TABLE IF EXISTS fixedassetcategory;

--
-- Set default database
--
USE hcsn;

--
-- Create table `fixedassetcategory`
--
CREATE TABLE fixedassetcategory (
  FixedAssetCategoryId char(36) NOT NULL COMMENT 'Id loại tài sản',
  FixedAssetCategoryCode varchar(50) DEFAULT NULL COMMENT 'Mã loại tài sản',
  FixedAssetCategoryName varchar(255) DEFAULT NULL COMMENT 'Tên loại tài sản',
  OrganizationId char(36) DEFAULT NULL COMMENT 'Id của đơn vị',
  DepreciationRate float DEFAULT NULL COMMENT 'Tỷ lệ hao mòn (%)',
  LifeTime int DEFAULT NULL COMMENT 'Số năm sử dụng ',
  Description varchar(500) DEFAULT NULL COMMENT 'Ghi chú',
  CreatedBy varchar(50) DEFAULT NULL COMMENT 'Người tạo',
  CreatedDate timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Ngày tạo',
  ModifiedBy varchar(50) DEFAULT NULL COMMENT 'Người sửa',
  ModifiedDate timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Ngày sửa',
  PRIMARY KEY (FixedAssetCategoryId)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 1638,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci,
COMMENT = 'Loại tài sản';

DELIMITER $$

--
-- Create procedure `GetAllFixedAssetCategory`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE GetAllFixedAssetCategory ()
BEGIN
  SELECT
    *
  FROM FixedAssetCategory a;
END
$$

DELIMITER ;

--
-- Create table `department`
--
CREATE TABLE department (
  DepartmentId char(36) NOT NULL DEFAULT '' COMMENT 'ID phòng ban',
  DepartmentCode varchar(100) NOT NULL DEFAULT '' COMMENT 'Mã phòng ban',
  DepartmentName varchar(255) DEFAULT '' COMMENT 'Tên phòng ban',
  DepartmentDescription varchar(255) DEFAULT '' COMMENT 'Mô tả phòng ban',
  DepartmentIsParent tinyint DEFAULT NULL COMMENT 'Thuộc tính xác nhận phòng ban hiện tại có phải phòng ban cha hay không',
  DepartmentParentId char(36) DEFAULT '' COMMENT 'ID của phòng ban cha',
  DepartmentOrganizerId char(36) DEFAULT '' COMMENT 'ID Của người tổ chức phòng ban',
  CreatedDate datetime DEFAULT NULL COMMENT 'Ngày tạo',
  CreatedBy varchar(255) DEFAULT NULL COMMENT 'Người tạo',
  ModifiedDate datetime DEFAULT NULL COMMENT 'Ngày chỉnh sửa',
  ModifiedBy varchar(255) DEFAULT NULL COMMENT 'chỉnh sửa bởi',
  PRIMARY KEY (DepartmentId)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 4096,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng phòng ban';

DELIMITER $$

--
-- Create procedure `GetAllDepartment`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE GetAllDepartment ()
COMMENT 'Lấy toàn bộ phòng ban'
BEGIN
  SELECT
    *
  FROM department d;
END
$$

DELIMITER ;

--
-- Create table `fixedasset`
--
CREATE TABLE fixedasset (
  FixedAssetId char(36) NOT NULL DEFAULT '' COMMENT 'Id tài sản',
  FixedAssetCode varchar(50) NOT NULL DEFAULT '' COMMENT 'Mã tài sản',
  FixedAssetName varchar(100) NOT NULL DEFAULT '' COMMENT 'Tên tài sản',
  OrganizationId char(36) DEFAULT '' COMMENT 'Id tổ chức',
  OrganizationCode varchar(100) DEFAULT '' COMMENT 'Mã tổ chức',
  OrganizationName varchar(255) DEFAULT '' COMMENT 'Tên tổ chức',
  DepartmentId char(36) DEFAULT '' COMMENT 'Id của phòng ban',
  DepartmentCode varchar(100) DEFAULT '' COMMENT 'Mã phòng ban',
  DepartmentName varchar(255) DEFAULT '' COMMENT 'Tên phòng ban',
  FixedAssetCategoryId char(36) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL DEFAULT '' COMMENT 'Id loại tài sản',
  FixedAssetCategoryCode varchar(100) DEFAULT '' COMMENT 'Mã loại tài sản',
  FixedAssetCategoryName varchar(255) DEFAULT '' COMMENT 'Tên loại tài sản',
  PurchaseDate datetime DEFAULT NULL COMMENT 'Ngày mua',
  StartUsingDate datetime DEFAULT NULL COMMENT 'Ngày bắt đầu sửu dụng',
  Cost decimal(10, 0) DEFAULT NULL COMMENT 'Nguyên giá',
  Quantity int DEFAULT NULL COMMENT 'Số lượng ',
  DepreciationRate float DEFAULT NULL COMMENT 'Tỉ lệ hao mòn',
  TrackedYear int DEFAULT NULL COMMENT 'Năm bắt đầu theo dõi',
  LifeTime int DEFAULT NULL COMMENT 'Số năm sử dụng',
  ProductionYear int DEFAULT NULL COMMENT 'Năm bắt đầu sử dụng',
  Active tinyint DEFAULT NULL COMMENT 'trạng thái tài sản',
  CreatedDate datetime DEFAULT NULL COMMENT 'Ngày tạo',
  CreatedBy varchar(255) DEFAULT NULL COMMENT 'Người tạo',
  ModifiedDate datetime DEFAULT NULL COMMENT 'Ngày chỉnh sửa',
  ModifiedBy varchar(255) DEFAULT NULL COMMENT 'Người chỉnh sửa',
  PRIMARY KEY (FixedAssetId)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 630,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng tài sản';

--
-- Create index `FixedAssetCode` on table `fixedasset`
--
ALTER TABLE fixedasset
ADD UNIQUE INDEX FixedAssetCode (FixedAssetCode);

--
-- Create foreign key
--
ALTER TABLE fixedasset
ADD CONSTRAINT FK_asset_DepartmentId FOREIGN KEY (DepartmentId)
REFERENCES department (DepartmentId);

--
-- Create foreign key
--
ALTER TABLE fixedasset
ADD CONSTRAINT FK_fixedasset_FixedAssetCategoryId FOREIGN KEY (FixedAssetCategoryId)
REFERENCES fixedassetcategory (FixedAssetCategoryId);

DELIMITER $$

--
-- Create function `Func_GetNewFixedAssetCode`
--
CREATE DEFINER = 'root'@'localhost'
FUNCTION Func_GetNewFixedAssetCode ()
RETURNS varchar(20) CHARSET utf8mb4
READS SQL DATA
COMMENT 'Sinh mã tài sản gợi ý'
BEGIN
  DECLARE FixedAssetCodeOld varchar(20);
  -- Lấy ra mã tài sản được sửa đổi gần nhất
  SET FixedAssetCodeOld = (SELECT
      fa.FixedAssetCode
    FROM fixedasset fa
    ORDER BY fa.ModifiedDate DESC LIMIT 1);

  -- Nếu không tồn lại thì sinh mặc định là 01
  IF (NOT EXISTS (SELECT
        *
      FROM fixedasset fa)) THEN
    RETURN 'TS001';
  END IF;

  -- Kiểm tra đến khi mã tài sản không còn bị trùng 
  WHILE
    (FixedAssetCodeOld IN (SELECT
        fa.FixedAssetCode
      FROM fixedasset fa)) DO
    IF REGEXP_SUBSTR(FixedAssetCodeOld, '(?!0)([0-9]*$)') = '' THEN
      SET FixedAssetCodeOld = REGEXP_REPLACE(FixedAssetCodeOld, '(?!0)([0-9]*$)', CONVERT(CONVERT(REGEXP_SUBSTR(FixedAssetCodeOld, '(?!0)([0-9]*)'), binary) + 1, char(20)));
    ELSE
      SET FixedAssetCodeOld = REGEXP_REPLACE(FixedAssetCodeOld, '(?!0)([0-9]+$)', CONVERT(CONVERT(REGEXP_SUBSTR(FixedAssetCodeOld, '(?!0)([0-9]+$)'), binary) + 1, char(20)));
    END IF;
  END WHILE;

  RETURN FixedAssetCodeOld;

END
$$

--
-- Create procedure `Proc_GetNewFixedAssetCode`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetNewFixedAssetCode ()
COMMENT 'Lấy mã tài sản mới'
BEGIN
  SELECT
    Func_GetNewFixedAssetCode();
END
$$

--
-- Create procedure `GetAllFixedAsset`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE GetAllFixedAsset ()
COMMENT 'Lấy toàn bộ tài sản'
BEGIN
  SELECT
    *
  FROM fixedasset f
  ORDER BY f.ModifiedDate DESC;
END
$$

--
-- Create procedure `FixedAssetUpdate`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE FixedAssetUpdate (IN Id char(36),
IN FixedAssetCode varchar(100),
IN FixedAssetName varchar(255),
IN DepartmentId char(36),
IN DepartmentCode varchar(50),
IN DepartmentName varchar(255),
IN FixedAssetCategoryId char(36),
IN FixedAssetCategoryCode varchar(50),
IN FixedAssetCategoryName varchar(255),
IN PurchaseDate datetime,
IN StartUsingDate datetime,
IN Cost decimal(19, 4),
IN Quantity int,
IN DepreciationRate float,
IN TrackedYear int,
IN LifeTime int,
IN ProductionYear int,
IN Active bit,
IN ModifiedBy varchar(50))
COMMENT 'Cập nhật tài sản'
BEGIN
  UPDATE fixedasset f
  SET FixedAssetCode = FixedAssetCode,
      FixedAssetName = FixedAssetName,
      DepartmentId = DepartmentId,
      DepartmentCode = DepartmentCode,
      DepartmentName = DepartmentName,
      FixedAssetCategoryId = FixedAssetCategoryId,
      FixedAssetCategoryCode = FixedAssetCategoryCode,
      FixedAssetCategoryName = FixedAssetCategoryName,
      PurchaseDate = PurchaseDate,
      StartUsingDate = StartUsingDate,
      Cost = Cost,
      Quantity = Quantity,
      DepreciationRate = DepreciationRate,
      TrackedYear = TrackedYear,
      LifeTime = LifeTime,
      ProductionYear = ProductionYear,
      Active = Active,
      ModifiedDate = NOW(),
      ModifiedBy = ModifiedBy
  WHERE FixedAssetId = Id;
END
$$

--
-- Create procedure `FixedAsset_Create`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE FixedAsset_Create (IN FixedAssetCode varchar(100), IN FixedAssetName varchar(255), IN OrganizationId char(36), IN OrganizationCode varchar(50), IN OrganizationName varchar(255), IN DepartmentId char(36), IN DepartmentCode varchar(50), IN DepartmentName varchar(255), IN FixedAssetCategoryId char(36), IN FixedAssetCategoryCode varchar(50), IN FixedAssetCategoryName varchar(255), IN PurchaseDate datetime, IN StartUsingDate datetime, IN Cost decimal(19, 4), IN Quantity int, IN DepreciationRate float, IN TrackedYear int, IN LifeTime int, IN ProductionYear int, IN Active bit, IN CreatedBy varchar(50), IN CreatedDate datetime, IN ModifiedBy varchar(50))
COMMENT 'Thêm tài sản'
BEGIN
  INSERT fixedasset (FixedAssetId, FixedAssetCode, FixedAssetName, OrganizationId, OrganizationCode, OrganizationName, DepartmentId, DepartmentCode, DepartmentName, FixedAssetCategoryId, FixedAssetCategoryCode, FixedAssetCategoryName, PurchaseDate, StartUsingDate, Cost, Quantity, DepreciationRate, TrackedYear, LifeTime, ProductionYear, Active, CreatedDate, CreatedBy, ModifiedDate, ModifiedBy)
    VALUES (UUID(), FixedAssetCode, FixedAssetName, OrganizationId, OrganizationCode, OrganizationName, DepartmentId, DepartmentCode, DepartmentName, FixedAssetCategoryId, FixedAssetCategoryCode, FixedAssetCategoryName, PurchaseDate, StartUsingDate, Cost, Quantity, DepreciationRate, TrackedYear, LifeTime, ProductionYear, Active, NOW(), CreatedBy, NOW(), ModifiedBy);
END
$$

DELIMITER ;

--
-- Create view `view_fixed_asset_category`
--
CREATE
DEFINER = 'root'@'localhost'
VIEW view_fixed_asset_category
AS
SELECT
  `a`.`FixedAssetId` AS `FixedAssetId`,
  `a`.`FixedAssetCode` AS `FixedAssetCode`,
  `a`.`FixedAssetName` AS `FixedAssetName`,
  `a`.`OrganizationId` AS `OrganizationId`,
  `a`.`OrganizationCode` AS `OrganizationCode`,
  `a`.`OrganizationName` AS `OrganizationName`,
  `a`.`DepartmentId` AS `DepartmentId`,
  `a`.`DepartmentCode` AS `DepartmentCode`,
  `a`.`DepartmentName` AS `DepartmentName`,
  `a`.`FixedAssetCategoryId` AS `FixedAssetCategoryId`,
  `a`.`FixedAssetCategoryCode` AS `FixedAssetCategoryCode`,
  `a`.`FixedAssetCategoryName` AS `FixedAssetCategoryName`,
  `a`.`PurchaseDate` AS `PurchaseDate`,
  `a`.`StartUsingDate` AS `StartUsingDate`,
  `a`.`Cost` AS `Cost`,
  `a`.`Quantity` AS `Quantity`,
  `a`.`DepreciationRate` AS `DepreciationRate`,
  `a`.`TrackedYear` AS `TrackedYear`,
  `a`.`LifeTime` AS `LifeTime`,
  `a`.`ProductionYear` AS `ProductionYear`,
  `a`.`Active` AS `Active`,
  `a`.`CreatedDate` AS `CreatedDate`,
  `a`.`CreatedBy` AS `CreatedBy`,
  `a`.`ModifiedDate` AS `ModifiedDate`,
  `a`.`ModifiedBy` AS `ModifiedBy`
FROM `fixedasset` `a`;

--
-- Create view `view_fixed_asset`
--
CREATE
DEFINER = 'root'@'localhost'
VIEW view_fixed_asset
AS
SELECT
  `fixedasset`.`FixedAssetId` AS `FixedAssetId`,
  `fixedasset`.`FixedAssetCode` AS `FixedAssetCode`,
  `fixedasset`.`FixedAssetName` AS `FixedAssetName`,
  `fixedasset`.`OrganizationId` AS `OrganizationId`,
  `fixedasset`.`OrganizationCode` AS `OrganizationCode`,
  `fixedasset`.`OrganizationName` AS `OrganizationName`,
  `fixedasset`.`DepartmentId` AS `DepartmentId`,
  `fixedasset`.`DepartmentCode` AS `DepartmentCode`,
  `fixedasset`.`DepartmentName` AS `DepartmentName`,
  `fixedasset`.`FixedAssetCategoryId` AS `FixedAssetCategoryId`,
  `fixedasset`.`FixedAssetCategoryCode` AS `FixedAssetCategoryCode`,
  `fixedasset`.`FixedAssetCategoryName` AS `FixedAssetCategoryName`,
  `fixedasset`.`PurchaseDate` AS `PurchaseDate`,
  `fixedasset`.`StartUsingDate` AS `StartUsingDate`,
  `fixedasset`.`Cost` AS `Cost`,
  `fixedasset`.`Quantity` AS `Quantity`,
  `fixedasset`.`DepreciationRate` AS `DepreciationRate`,
  `fixedasset`.`TrackedYear` AS `TrackedYear`,
  `fixedasset`.`LifeTime` AS `LifeTime`,
  `fixedasset`.`ProductionYear` AS `ProductionYear`,
  `fixedasset`.`Active` AS `Active`,
  `fixedasset`.`CreatedDate` AS `CreatedDate`,
  `fixedasset`.`CreatedBy` AS `CreatedBy`,
  `fixedasset`.`ModifiedDate` AS `ModifiedDate`,
  `fixedasset`.`ModifiedBy` AS `ModifiedBy`
FROM `fixedasset`
ORDER BY `fixedasset`.`ModifiedDate` DESC;

--
-- Create table `transferasset`
--
CREATE TABLE transferasset (
  TransferAssetId char(36) NOT NULL DEFAULT '' COMMENT 'Id của chứng từ',
  TransferAssetCode varchar(20) NOT NULL DEFAULT '' COMMENT 'Mã của chứng từ',
  TransactionDate timestamp NULL DEFAULT NULL COMMENT 'Ngày chứng từ',
  TransferDate timestamp NULL DEFAULT NULL COMMENT 'Ngày điều chuyển',
  RemainCost decimal(19, 4) DEFAULT NULL COMMENT 'Giá trị còn lại',
  Cost decimal(19, 4) UNSIGNED DEFAULT NULL COMMENT 'Nguyên giá',
  Note varchar(255) DEFAULT NULL COMMENT 'Ghi chú',
  CreatedBy varchar(50) DEFAULT NULL COMMENT 'Người tạo',
  CreatedDate timestamp NULL DEFAULT NULL COMMENT 'Ngày tạo',
  ModifiedBy varchar(50) DEFAULT NULL COMMENT 'Người sửa đổi',
  ModifiedDate timestamp NULL DEFAULT NULL COMMENT 'Ngày sửa đổi',
  PRIMARY KEY (TransferAssetId)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 16384,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng điều chuyển tài sản';

DELIMITER $$

--
-- Create function `Func_GetNewTransferAssetCode`
--
CREATE DEFINER = 'root'@'localhost'
FUNCTION Func_GetNewTransferAssetCode ()
RETURNS varchar(20) CHARSET utf8mb4
READS SQL DATA
COMMENT 'Function sinh mã chứng từ mới'
BEGIN
  DECLARE TransferAssetCodeOld varchar(20);
  -- Lấy ra mã tài sản được sửa đổi gần nhất
  SET TransferAssetCodeOld = (SELECT
      fa.TransferAssetCode
    FROM Transferasset fa
    ORDER BY fa.ModifiedDate DESC LIMIT 1);

  -- Nếu không tồn lại thì sinh mặc định là 01
  IF (NOT EXISTS (SELECT
        *
      FROM Transferasset fa)) THEN
    RETURN 'CT001';
  END IF;

  -- Kiểm tra đến khi mã tài sản không còn bị trùng 
  WHILE
    (TransferAssetCodeOld IN (SELECT
        fa.TransferAssetCode
      FROM Transferasset fa)) DO
    IF REGEXP_SUBSTR(TransferAssetCodeOld, '(?!0)([0-9]*$)') = '' THEN
      SET TransferAssetCodeOld = REGEXP_REPLACE(TransferAssetCodeOld, '(?!0)([0-9]*$)', CONVERT(CONVERT(REGEXP_SUBSTR(TransferAssetCodeOld, '(?!0)([0-9]*)'), binary) + 1, char(20)));
    ELSE
      SET TransferAssetCodeOld = REGEXP_REPLACE(TransferAssetCodeOld, '(?!0)([0-9]+$)', CONVERT(CONVERT(REGEXP_SUBSTR(TransferAssetCodeOld, '(?!0)([0-9]+$)'), binary) + 1, char(20)));
    END IF;
  END WHILE;

  RETURN TransferAssetCodeOld;
END
$$

--
-- Create procedure `Proc_GetNewTransferAssetCode`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetNewTransferAssetCode ()
COMMENT 'Lấy mã chứng từ mới'
BEGIN
  SELECT
    Func_GetNewTransferAssetCode();
END
$$

--
-- Create procedure `TransferAssetUpdate`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE TransferAssetUpdate (IN Id char(36), IN TransferAssetCode varchar(255), IN TransferDate datetime, IN TransactionDate datetime, IN Note varchar(255), IN RemainCost decimal(19, 4), IN Cost decimal(19, 4))
COMMENT 'proc cập nhật chứng từ'
BEGIN
  UPDATE transferasset t
  SET TransferAssetCode = TransferAssetCode,
      TransactionDate = TransactionDate,
      TransferDate = TransferDate,
      RemainCost = RemainCost,
      Cost = Cost,
      Note = Note,
      ModifiedDate = NOW()
  WHERE TransferAssetId = Id;
END
$$

--
-- Create procedure `TransferAsset_Create`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE TransferAsset_Create (IN TransferAssetId char(36), IN TransferAssetCode varchar(50), IN TransactionDate timestamp, IN TransferDate timestamp, IN RemainCost decimal(19, 4), IN Cost decimal(19, 4), IN Note varchar(255))
COMMENT 'Tạo ra 1 chứng từ mới'
BEGIN
  INSERT transferasset (TransferAssetId, TransferAssetCode, TransactionDate, TransferDate, RemainCost, Cost, Note, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
    VALUES (TransferAssetId, TransferAssetCode, TransactionDate, TransferDate, RemainCost, Cost, Note, '', NOW(), '', NOW());
END
$$

--
-- Create procedure `Proc_TransferAssetPaging`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_TransferAssetPaging (OUT TransferAssetTotal int, IN PageLimit int, IN PageNumber int)
COMMENT 'Lấy ra tất cả chứng từ'
BEGIN
  SET @rowIndex = 0;
  SET @PagingQuery = 'SELECT * FROM TransferAsset ta';

  -- Trả về tổng số chứng từ điều chuyển tài sản
  SET TransferAssetTotal = (SELECT
      COUNT(*)
    FROM transferAsset ta);

  SET @PagingQuery = CONCAT(@PagingQuery, ' ORDER By ta.ModifiedDate DESC LIMIT ', PageLimit, ' OFFSET ', (PageNumber - 1) * PageLimit, ';');

  PREPARE PagingQuery FROM @PagingQuery;
  EXECUTE PagingQuery;
  DEALLOCATE PREPARE PagingQuery;
END
$$

DELIMITER ;

--
-- Create table `transferassetdetail`
--
CREATE TABLE transferassetdetail (
  TransferAssetDetailId char(36) NOT NULL DEFAULT '',
  FixedAssetId char(36) NOT NULL DEFAULT '' COMMENT 'Id của tài sản',
  FixedAssetCode varchar(20) NOT NULL DEFAULT '' COMMENT 'Mã của tài sản',
  FixedAssetName varchar(100) NOT NULL DEFAULT '' COMMENT 'Tên của tài sản',
  Cost decimal(19, 4) UNSIGNED DEFAULT NULL COMMENT 'Nguyên giá',
  RemainderCost decimal(19, 4) UNSIGNED DEFAULT NULL COMMENT 'Giá trị còn lại',
  OldDepartmentId char(36) DEFAULT NULL COMMENT 'Id của bộ phận đang sử dụng',
  OldDepartmentName varchar(100) NOT NULL DEFAULT '' COMMENT 'Tên bộ phận đang sử dụng',
  TransferDepartmentId char(36) DEFAULT NULL COMMENT 'Id của bộ phận điều chuyển',
  TransferDepartmentName varchar(100) NOT NULL DEFAULT '' COMMENT 'Tên bộ phận điều chuyển',
  Reason varchar(255) DEFAULT NULL COMMENT 'Lý do điều chuyển',
  TransferAssetId char(36) NOT NULL DEFAULT '' COMMENT 'Id của chứng từ',
  CreatedBy varchar(50) DEFAULT NULL COMMENT 'Người tạo',
  CreatedDate timestamp NULL DEFAULT NULL COMMENT 'Ngày tạo',
  ModifiedBy varchar(50) DEFAULT NULL COMMENT 'Người sửa đổi',
  ModifiedDate timestamp NULL DEFAULT NULL COMMENT 'Ngày sửa đổi',
  PRIMARY KEY (TransferAssetDetailId)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng chi tiết tài sản điều chuyển';

--
-- Create foreign key
--
ALTER TABLE transferassetdetail
ADD CONSTRAINT FK_transfer_asset_detail_TransferAssetId FOREIGN KEY (TransferAssetId)
REFERENCES transferasset (TransferAssetId);

--
-- Create view `view_transfer_asset_detail`
--
CREATE
DEFINER = 'root'@'localhost'
VIEW view_transfer_asset_detail
AS
SELECT
  `tad`.`TransferAssetDetailId` AS `TransferAssetDetailId`,
  `tad`.`FixedAssetId` AS `FixedAssetId`,
  `tad`.`FixedAssetCode` AS `FixedAssetCode`,
  `tad`.`FixedAssetName` AS `FixedAssetName`,
  `tad`.`Cost` AS `Cost`,
  `tad`.`RemainderCost` AS `RemainderCost`,
  `tad`.`OldDepartmentId` AS `OldDepartmentId`,
  `tad`.`OldDepartmentName` AS `OldDepartmentName`,
  `tad`.`TransferDepartmentId` AS `TransferDepartmentId`,
  `tad`.`TransferDepartmentName` AS `TransferDepartmentName`,
  `tad`.`Reason` AS `Reason`,
  `tad`.`TransferAssetId` AS `TransferAssetId`,
  `tad`.`CreatedBy` AS `CreatedBy`,
  `tad`.`CreatedDate` AS `CreatedDate`,
  `tad`.`ModifiedBy` AS `ModifiedBy`,
  `tad`.`ModifiedDate` AS `ModifiedDate`
FROM `transferassetdetail` `tad`
ORDER BY `tad`.`ModifiedDate` DESC;

--
-- Create table `receiver`
--
CREATE TABLE receiver (
  ReceiverId char(36) NOT NULL DEFAULT '' COMMENT 'Id của người nhận',
  ReceiverOrder int UNSIGNED DEFAULT NULL COMMENT 'Số thứ tự',
  Fullname varchar(100) DEFAULT NULL COMMENT 'Họ và tên của người nhận',
  Delegate varchar(100) DEFAULT NULL COMMENT 'Đại diện',
  Position varchar(100) DEFAULT NULL COMMENT 'Chức vụ',
  TransferAssetId char(36) NOT NULL DEFAULT '' COMMENT 'Id của chứng từ',
  CreatedBy char(50) DEFAULT NULL COMMENT 'Người tạo',
  CreatedDate timestamp NULL DEFAULT NULL COMMENT 'Ngày tạo',
  ModifiedBy char(50) DEFAULT NULL COMMENT 'Người sửa đổi',
  ModifiedDate timestamp NULL DEFAULT NULL COMMENT 'Ngày sửa đổi'
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 16384,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Người giao nhận';

--
-- Create foreign key
--
ALTER TABLE receiver
ADD CONSTRAINT FK_receiver_TransferAssetId FOREIGN KEY (TransferAssetId)
REFERENCES transferasset (TransferAssetId);

DELIMITER $$

--
-- Create procedure `GetAllReceiver`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE GetAllReceiver ()
COMMENT 'Proc lấy toàn bộ người nhận'
BEGIN
  SELECT
    *
  FROM receiver r;
END
$$

--
-- Create procedure `Proc_GetTransferDetaiByAssetId`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetTransferDetaiByAssetId (IN p_List varchar(1000))
BEGIN
  SET @query = CONCAT('
    SELECT
      vtad.TransferAssetDetailId,
      vtad.FixedAssetId,
      vtad.TransferAssetId,
      ta.TransferAssetcode as TransferAssetCode,
      ta.TransactionDate as TransactionDate,
      ta.Transferdate as TransferDate,
      vtad.OldDepartmentId,
      vtad.TransferDepartmentId,
      vtad.Reason,
      vtad.ModifiedDate
    FROM view_transfer_asset_detail vtad
    INNER JOIN TransferAsset ta ON vtad.TransferAssetId = ta.TransferAssetId
    WHERE vtad.FixedAssetId IN (''', REPLACE(p_List, ',', ''','''), ''')
    ORDER BY vtad.ModifiedDate DESC');

  PREPARE stmt FROM @query;
  EXECUTE stmt;
  DEALLOCATE PREPARE stmt;
END
$$

--
-- Create procedure `Proc_GetNewestTransferAssetByAssetId`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetNewestTransferAssetByAssetId (IN p_List varchar(1000))
COMMENT 'lấy ra những chứng từ mới nhất trong những chứng từ mà tài sản được ref tới'
BEGIN
  SET @query = CONCAT('
    SELECT
DISTINCT
      vta.*
    FROM view_fixed_asset vfa
      INNER JOIN view_transfer_asset_detail vtad
        ON vfa.FixedAssetId = vtad.FixedAssetId
      INNER JOIN TransferAsset vta
        ON vtad.TransferAssetId = vta.TransferAssetId
    WHERE vfa.FixedAssetId IN (''', REPLACE(p_List, ',', ''','''), ''')
    ORDER BY vta.TransferDate DESC limit 2;
  ');
  PREPARE stmt FROM @query;
  EXECUTE stmt;
  DEALLOCATE PREPARE stmt;
END
$$

--
-- Create procedure `Proc_GetFixedAssetTransferPaging`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetFixedAssetTransferPaging (IN PageLimit int, IN PageNumber int, IN FixedAssetIdIgnores varchar(16000),
IN TransferAssetDetailIdIgnores varchar(16000), OUT FixedAssetTotal int)
COMMENT 'Lấy ra danh sách tài sản cập nhật theo phòng ban mới nhất'
BEGIN
  -- Base Query 
  SET @FixedAssetQuery = '((SELECT
          fa.FixedAssetId,
          fa.FixedAssetCode,
          fa.FixedAssetName,
          fa.DepartmentId,
          fa.DepartmentName,
          fa.Cost,
          fa.RemainderCost,
          fa.TrackedYear,
          fa.ModifiedDate
        FROM fixedasset fa
        WHERE fa.FixedAssetId NOT IN (SELECT
            tad.FixedAssetId
          FROM transferassetdetail tad';

  SET @TransferAssetDetailQuery = ' (SELECT
          tad.FixedAssetId,
          tad.FixedAssetCode,
          tad.FixedAssetName,
          tad.TransferDepartmentId AS DepartmentId,
          tad.TransferDepartmentName AS DepartmentName,
          tad.Cost,
          tad.RemainderCost,
          tad.TrackedYear,
          tad.ModifiedDate
        FROM transferassetdetail tad
          INNER JOIN (SELECT
              tad.FixedAssetId,
              MAX(tad.ModifiedDate) AS MAXModifiedDate
            FROM transferassetdetail tad';

  SET @TransferAssetDetailWhere = ' ';
  IF (TransferAssetDetailIdIgnores IS NOT NULL) THEN
    SET @TransferAssetDetailWhere = CONCAT(' WHERE ', QUOTE(TransferAssetDetailIdIgnores), ' NOT LIKE CONCAT(\'%\', tad.TransferAssetDetailId, \'%\') ');
  END IF;

  SET @FixedAssetQuery = CONCAT(@FixedAssetQuery, @TransferAssetDetailWhere, ')) UNION');
  SET @TransferAssetDetailQuery = CONCAT(@TransferAssetDetailQuery, @TransferAssetDetailWhere, 'GROUP BY tad.FixedAssetId) t2
            ON tad.FixedAssetId = t2.FixedAssetId
            AND tad.ModifiedDate = t2.MAXModifiedDate)) AS t');

  SET @BaseQuery = CONCAT(@FixedAssetQuery, @TransferAssetDetailQuery);
  SET @Where = ' ';
  IF (FixedAssetIdIgnores IS NOT NULL) THEN
    SET @Where = CONCAT(' WHERE ', QUOTE(FixedAssetIdIgnores), ' NOT LIKE CONCAT(\'%\', t.FixedAssetId, \'%\')');
  END IF;

  -- Lấy tổng số bản ghi
  SET @Total = 0;
  SET @TotalQuery = CONCAT('SELECT COUNT(*) INTO @Total FROM ', @BaseQuery, @Where, ';');
  PREPARE TotalQuery FROM @TotalQuery;
  EXECUTE TotalQuery;
  SET FixedAssetTotal = (SELECT
      @Total);
  DEALLOCATE PREPARE TotalQuery;

  --   Danh sách bản ghi phân trang
  SET @Query = CONCAT('SELECT * FROM ', @BaseQuery, @Where, ' ORDER BY t.ModifiedDate DESC', ' LIMIT ', PageLimit, ' OFFSET ', PageLimit * (PageNumber - 1), ';');
  PREPARE QUERY FROM @Query;
  EXECUTE QUERY;
  DEALLOCATE PREPARE QUERY;
END
$$

--
-- Create procedure `Proc_GetFixedAssetPaging`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetFixedAssetPaging (IN FixedAssetCodeOrName varchar(100), IN DepartmentName varchar(100), IN FixedAssetCategoryName varchar(100), IN PageLimit int, IN PageNumber int)
COMMENT 'Lấy tài sản theo các điều kiện lọc, phân trang'
BEGIN
  -- Khởi tạo biến lưu câu truy vấn
  SET @RowIndex = 0;
  SET @WhereQuery = 'SELECT (@RowIndex:=@RowIndex+1) AS RowIndex, fa.* FROM FixedAsset fa ';

  -- Cắt bỏ phần khoảng trắng đầu và cuối
  SET FixedAssetCodeOrName = TRIM(FixedAssetCodeOrName);
  SET DepartmentName = TRIM(DepartmentName);
  SET FixedAssetCategoryName = TRIM(FixedAssetCategoryName);

  -- Xử lý điều kiện tìm kiếm
  IF (FixedAssetCodeOrName <> '') THEN
    SET @WhereQuery = CONCAT(@WhereQuery, 'WHERE (LOWER(fa.FixedAssetCode) LIKE CONCAT(\'%\', LOWER(', QUOTE(FixedAssetCodeOrName), '), \'%\') OR LOWER(fa.FixedAssetName) LIKE CONCAT(\'%\', LOWER(', QUOTE(FixedAssetCodeOrName), '), \'%\'))');
  END IF;

  IF (DepartmentName <> '') THEN
    IF (FixedAssetCodeOrName <> '') THEN
      SET @WhereQuery = CONCAT(@WhereQuery, ' AND ');
    ELSE
      SET @WhereQuery = CONCAT(@WhereQuery, 'WHERE ');
    END IF;
    SET @WhereQuery = CONCAT(@WhereQuery, 'LOWER(fa.DepartmentName) LIKE CONCAT(\'%\', LOWER(', QUOTE(DepartmentName), '), \'%\')');
  END IF;

  IF (FixedAssetCategoryName <> '') THEN
    IF (FixedAssetCodeOrName <> ''
      OR DepartmentName <> '') THEN
      SET @WhereQuery = CONCAT(@WhereQuery, ' AND ');
    ELSE
      SET @WhereQuery = CONCAT(@WhereQuery, 'WHERE ');
    END IF;
    SET @WhereQuery = CONCAT(@WhereQuery, 'LOWER(fa.FixedAssetCategoryName) LIKE CONCAT(\'%\', LOWER(', QUOTE(FixedAssetCategoryName), '), \'%\')');
  END IF;

  -- Sắp xếp kết quả
  SET @WhereQuery = CONCAT(@WhereQuery, ' ORDER BY fa.ModifiedDate DESC');

  -- Phân trang
  SET @WhereQuery = CONCAT('SELECT * FROM (', @WhereQuery, ') AS Asset LIMIT ', (PageNumber - 1) * PageLimit, ', ', PageLimit);

  -- Thực thi câu truy vấn
  PREPARE query FROM @WhereQuery;
  EXECUTE query;
  DEALLOCATE PREPARE query;
END
$$

--
-- Create procedure `Proc_GetAllTransferAssetOfAsset`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetAllTransferAssetOfAsset (IN p_List varchar(1000))
COMMENT 'Truyền vào 1 danh sách chứng từ, tìm các tài sản trong chứng từ đó, rồi tìm tất cả các chứng từ có chứa các tài sản này'
BEGIN
  SET @query = CONCAT('
  SELECT
    vta.*,
    vfa.FixedAssetId
  FROM TransferAsset vta
    INNER JOIN view_transfer_asset_detail vtad
      ON vta.TransferAssetId = vtad.TransferAssetId
    INNER JOIN view_fixed_asset vfa
      ON vtad.FixedAssetId = vfa.FixedAssetId
  WHERE vfa.FixedAssetId IN (SELECT
      MaxDates.FixedAssetId
    FROM (SELECT
        vfa.FixedAssetId,
        vta.TransferAssetId,
        vta.CreatedDate
      FROM view_fixed_asset vfa
        INNER JOIN view_transfer_asset_detail vtad
          ON vfa.FixedAssetId = vtad.FixedAssetId
        INNER JOIN TransferAsset vta
          ON vtad.TransferAssetId = vta.TransferAssetId
      WHERE vta.TransferAssetId IN (''', REPLACE(p_List, ',', ''','''), ''')
      GROUP BY vfa.FixedAssetId) AS MaxDates)
  ORDER BY vta.CreatedDate DESC');
  SET sql_mode = '';
  PREPARE stmt FROM @query;
  EXECUTE stmt;
  DEALLOCATE PREPARE stmt;
END
$$

--
-- Create procedure `Proc_GetAllFixedAssetFilter`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_GetAllFixedAssetFilter (IN FixedAssetCodeOrName varchar(100),
IN DepartmentName varchar(100),
IN FixedAssetCategoryName varchar(100))
COMMENT 'lấy tổng số tài sản'
BEGIN
  -- Cắt bỏ phần khoảng trắng đầu và cuối
  SET FixedAssetCodeOrName = TRIM(FixedAssetCodeOrName);
  SET DepartmentName = TRIM(DepartmentName);
  SET FixedAssetCategoryName = TRIM(FixedAssetCategoryName);

  -- Khởi tạo biến lưu câu truy vấn
  SET @WhereQuery = 'SELECT COUNT(*) FROM fixedasset fa ';

  -- Tạo danh sách điều kiện
  SET @conditions = '';

  -- Xử lý điều kiện tìm kiếm
  IF (FixedAssetCodeOrName <> '') THEN
    SET @conditions = CONCAT(@conditions, ' (LOWER(fa.FixedAssetCode) LIKE CONCAT(\'%\', LOWER(', QUOTE(FixedAssetCodeOrName), '), \'%\') OR LOWER(fa.FixedAssetName) LIKE CONCAT(\'%\', LOWER(', QUOTE(FixedAssetCodeOrName), '), \'%\')) ');
  END IF;

  IF (DepartmentName <> '') THEN
    IF (@conditions <> '') THEN
      SET @conditions = CONCAT(@conditions, ' AND ');
    END IF;
    SET @conditions = CONCAT(@conditions, ' LOWER(fa.DepartmentName) LIKE CONCAT(\'%\', LOWER(', QUOTE(DepartmentName), '), \'%\') ');
  END IF;

  IF (FixedAssetCategoryName <> '') THEN
    IF (@conditions <> '') THEN
      SET @conditions = CONCAT(@conditions, ' AND ');
    END IF;
    SET @conditions = CONCAT(@conditions, ' LOWER(fa.FixedAssetCategoryName) LIKE CONCAT(\'%\', LOWER(', QUOTE(FixedAssetCategoryName), '), \'%\') ');
  END IF;

  -- Tạo mệnh đề WHERE nếu có điều kiện
  IF (@conditions <> '') THEN
    SET @WhereQuery = CONCAT(@WhereQuery, ' WHERE ', @conditions);
  END IF;

  -- Thực thi câu truy vấn
  PREPARE query FROM @WhereQuery;
  EXECUTE query;
  DEALLOCATE PREPARE query;
END
$$

--
-- Create procedure `Proc_FilterFixedAssetForTransfer`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_FilterFixedAssetForTransfer (IN p_PageNumber int, IN p_PageLimit int, IN p_List varchar(1000), OUT p_Count int, IN p_ListDetail varchar(10000))
BEGIN
  SET p_PageNumber = (p_PageNumber - 1) * p_PageLimit;
  -- Xây dựng câu truy vấn kết hợp với @where_query
  SET @query = CONCAT('
SELECT
    vfa.*
FROM
    view_fixed_asset vfa
WHERE
    vfa.FixedAssetId NOT IN (
        SELECT DISTINCT
            vtad.FixedAssetId
        FROM
            view_transfer_asset_detail vtad
    )

UNION

SELECT DISTINCT
    vfa.FixedAssetId,
    vfa.FixedAssetCode,
    vfa.FixedAssetName,
    vfa.OrganizationId,
    vfa.OrganizationCode,
    vfa.OrganizationName,
    vtad.TransferDepartmentId,
    vtad.NewDepartmentCode,
    vtad.TransferDepartmentName,
    vfa.FixedAssetCategoryId,
    vfa.FixedAssetCategoryCode,
    vfa.FixedAssetCategoryName,
    vfa.PurchaseDate,
    vfa.StartUsingDate,
    vfa.Cost,
    vfa.Quantity,
    vfa.DepreciationRate,
    vfa.TrackedYear,
    vfa.LifeTime,
    vfa.ProductionYear,
    vfa.Active,
    vfa.CreatedBy,
    vfa.CreatedDate,
    vfa.ModifiedBy,
    vfa.ModifiedDate
FROM
    view_fixed_asset vfa
INNER JOIN
    (
        SELECT
            FixedAssetId,
            TransferDepartmentId,
            d.departmentname AS TransferDepartmentName,
            d.departmentcode AS NewDepartmentCode,
            view_transfer_asset_detail.ModifiedDate,
        TransferAssetDetailId,
            ROW_NUMBER() OVER (PARTITION BY FixedAssetId ORDER BY ModifiedDate DESC) AS RowNum
        FROM
            view_transfer_asset_detail INNER JOIN department d ON view_transfer_asset_detail.TransferDepartmentId = d.departmentid
    ) vtad
ON
    vfa.FixedAssetId = vtad.FixedAssetId
WHERE
    vtad.TransferAssetDetailId NOT IN (''', REPLACE(p_ListDetail, ',', ''','''), ''') AND vtad.RowNum = 1
    
    UNION

SELECT DISTINCT
    vfa.FixedAssetId,
    vfa.FixedAssetCode,
    vfa.FixedAssetName,
    vfa.OrganizationId,
    vfa.OrganizationCode,
    vfa.OrganizationName,
    vtad.TransferDepartmentId,
    vtad.NewDepartmentCode,
    vtad.TransferDepartmentName,
    vfa.FixedAssetCategoryId,
    vfa.FixedAssetCategoryCode,
    vfa.FixedAssetCategoryName,
    vfa.PurchaseDate,
    vfa.StartUsingDate,
    vfa.Cost,
    vfa.Quantity,
    vfa.DepreciationRate,
    vfa.TrackedYear,
    vfa.LifeTime,
    vfa.ProductionYear,
    vfa.Active,
    vfa.CreatedBy,
    vfa.CreatedDate,
    vfa.ModifiedBy,
    vfa.ModifiedDate
FROM
    view_fixed_asset vfa
INNER JOIN
    (
        SELECT
            FixedAssetId,
            OldDepartmentId AS TransferDepartmentId,
            d.departmentname AS TransferDepartmentName,
            d.departmentcode AS NewDepartmentCode,
            view_transfer_asset_detail.ModifiedDate,
        TransferAssetDetailId,
            ROW_NUMBER() OVER (PARTITION BY FixedAssetId ORDER BY ModifiedDate DESC) AS RowNum
        FROM
            view_transfer_asset_detail INNER JOIN department d ON view_transfer_asset_detail.OldDepartmentId = d.departmentid
    ) vtad
ON
    vfa.FixedAssetId = vtad.FixedAssetId
WHERE
    vtad.TransferAssetDetailId IN (''', REPLACE(p_ListDetail, ',', ''','''), ''') AND vtad.RowNum = 1
    ) vfn WHERE vfn.FixedAssetId NOT IN (''', REPLACE(p_List, ',', ''','''), ''') ORDER BY vfn.ModifiedDate desc');

  SET @queryGet = CONCAT('SELECT * FROM (', @query, ' LIMIT ', p_PageLimit, ' OFFSET ', p_PageNumber);


  SET @total = 0;
  SET @querytotal = CONCAT('select count(*) INTO @total from (', @query);

  PREPARE stmtt FROM @querytotal;
  -- Thực thi câu truy vẫn
  EXECUTE stmtt;
  SET p_Count = (SELECT
      @total);
  -- Giải phóng bộ nhớ đã cấp phát cho câu truy vấn trên
  DEALLOCATE PREPARE stmtt;


  -- Chuẩn bị thực thi câu truy vấn
  PREPARE stmt FROM @queryGet;
  -- Thực thi câu truy vẫn
  EXECUTE stmt;
  -- Giải phóng bộ nhớ đã cấp phát cho câu truy vấn trên
  DEALLOCATE PREPARE stmt;
END
$$

--
-- Create procedure `Proc_FilterAsset`
--
CREATE DEFINER = 'root'@'localhost'
PROCEDURE Proc_FilterAsset (IN p_PageNumber int, IN p_PageLimit int, IN p_FilterName varchar(255),
IN p_DepartmentId varchar(255),
IN p_FixedAssetCategoryId varchar(255))
COMMENT 'Lấy danh sách tài sản, có thể phân trang, tìm kiếm theo tên tài sản'
BEGIN
  SET p_PageNumber = (p_PageNumber - 1) * p_PageLimit;

  -- Khởi tạo biến @where_query để lưu trữ điều kiện WHERE
  SET @where_query = '';

  -- Xây dựng điều kiện WHERE dựa trên các giá trị của p_DepartmentId, p_AssetTypeId và p_FilterName
  IF p_DepartmentId IS NOT NULL
    AND p_DepartmentId <> '' THEN
    SET @where_query = CONCAT(@where_query, ' AND vfa.DepartmentId = ', QUOTE(p_DepartmentId));
  END IF;

  IF p_FixedAssetCategoryId IS NOT NULL
    AND p_FixedAssetCategoryId <> '' THEN
    SET @where_query = CONCAT(@where_query, ' AND vfa.FixedAssetCategoryId = ', QUOTE(p_FixedAssetCategoryId));
  END IF;

  IF p_FilterName IS NOT NULL THEN
    SET @where_query = CONCAT(@where_query, ' AND (LOWER(vfa.FixedAssetCode) LIKE CONCAT(\'%\', LOWER(', QUOTE(p_FilterName), '), \'%\') OR LOWER(vfa.FixedAssetName) LIKE CONCAT(\'%\', LOWER(', QUOTE(p_FilterName), '), \'%\'))');
  END IF;

  -- Xóa dấu "AND" đầu tiên nếu có
  SET @where_query = SUBSTRING(@where_query, 6);
  -- Xây dựng câu truy vấn kết hợp với @where_query
  SET @query = CONCAT('SELECT * FROM view_fixed_asset vfa', IF(@where_query != '', CONCAT(' WHERE ', @where_query), ''), ' LIMIT ', p_PageLimit, ' OFFSET ', p_PageNumber);

  -- Chuẩn bị thực thi câu truy vấn
  PREPARE stmt FROM @query;
  -- Thực thi câu truy vẫn
  EXECUTE stmt;
  -- Giải phóng bộ nhớ đã cấp phát cho câu truy vấn trên
  DEALLOCATE PREPARE stmt;
END
$$

DELIMITER ;

-- 
-- Dumping data for table transferasset
--
INSERT INTO transferasset VALUES
('13dbc555-bad6-409c-a9cc-8df58f673a93', 'CT001', '2023-09-19 00:00:00', '2023-09-19 00:00:00', 3199600.0000, 5600000.0000, 'Ghi chú mẫu', '', '2023-09-19 08:40:51', '', '2023-09-19 08:41:23');

-- 
-- Dumping data for table fixedassetcategory
--
INSERT INTO fixedassetcategory VALUES
('60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '79aca385-65e3-1ebe-f488-479bce9b28fc', 8, 68, 'Assumenda odit cumque non voluptatibus placeat sunt qui error. Est architecto quas modi? Amet totam vero ipsum quaerat; voluptatem impedit recusandae amet perspiciatis. Deleniti animi voluptatum ut eius. Nisi deleniti error quia fugit ut et. Nostrum laborum corrupti eligendi veritatis. Deleniti eveniet sequi neque aut consequatur sequi. Autem eius vel aut dolores temporibus eos perferendis.', 'Merle Reiter', '2021-01-01 00:01:08', 'Brett Abney', '2023-05-26 23:11:14'),
('6207a9a7-3bf9-7288-8565-390639088226', 'AC03', 'Ngăn chứa', '3541ff76-58f0-6d1a-e836-63d5d5eff719', 5, 47, 'Eos nihil est dicta quo voluptates unde enim voluptatem. Nulla quis similique in voluptatem labore eaque animi. Quia doloribus dolores dignissimos nulla voluptatem error; ea quos dolore. Corporis ut aut et consequatur voluptatum omnis aliquam perspiciatis. Consequuntur omnis vel est autem error et repudiandae assumenda.', 'Britta Ayres', '2022-03-04 09:37:27', 'Araceli Kingsley', '2023-01-01 00:01:22'),
('6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '39446ba3-3071-7af6-a5a9-deaf32c96293', 4, 85, 'Qui sed et voluptatem ea tenetur et doloremque quas. Non delectus provident doloribus itaque aut mollitia qui quo. Quo sit amet eos soluta autem facilis rerum amet.', 'Bernard Creighton', '2021-01-01 01:08:43', 'Kim Charlton', '2023-06-12 12:20:49');

-- 
-- Dumping data for table department
--
INSERT INTO department VALUES
('148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', 'Sales', 1, '5e6695e2-5aad-3241-6c1a-bb545470e80c', '447816de-6069-15bf-de3d-c9e9e9038fe2', '2023-05-21 02:13:53', 'Elwood Ligon', '2023-02-16 19:34:58', 'Yadira Villanueva'),
('25c6c36e-1668-7d10-6e09-bf1378b8dc91', 'DC331', 'Phòng điều hành', 'Information Technology', 0, '6207a9a7-3bf9-7288-8565-390639088226', '3541ff76-58f0-6d1a-e836-63d5d5eff719', '2023-03-22 05:55:37', 'Courtney Abernathy', '2023-02-05 14:24:55', 'Britta Ayres'),
('354f1b13-17bf-1b52-87d5-ba100c6f7bce', 'DC115', 'Phòng đào tạo', 'Research and Development', 1, '60e226cb-63fb-4363-fc4d-8601bf3d85d8', '79aca385-65e3-1ebe-f488-479bce9b28fc', '2023-02-07 18:00:15', 'Natashia Blaylock', '2023-01-01 00:01:08', 'Merle Reiter'),
('3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', 'Sales', 0, '6d81a322-63f0-7270-6d1a-bb545470e80c', '39446ba3-3071-7af6-a5a9-deaf32c96293', '2021-08-14 15:45:11', 'Rose Aiello', '2023-01-01 01:08:43', 'Bernard Creighton');

-- 
-- Dumping data for table transferassetdetail
--
INSERT INTO transferassetdetail VALUES
('aa1b2dee-7d3b-4553-b9cc-6b45f02448cc', '1eb328d1-3c07-11ee-b2eb-d8bbc1b19349', 'TS0028', 'Máy tính để bàn', 4000000.0000, 1999600.0000, '148ed882-32b8-218e-9c20-39c2f00615e8', 'Phòng Sale', '25c6c36e-1668-7d10-6e09-bf1378b8dc91', 'Phòng điều hành', '', '13dbc555-bad6-409c-a9cc-8df58f673a93', NULL, NULL, NULL, '2023-09-19 08:40:52'),
('aeeda95a-9713-4abf-8d0e-850bfdd4b221', '5187d20c-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0021', 'Bàn làm việc', 800000.0000, 600000.0000, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'Phòng IT', '00000000-0000-0000-0000-000000000000', 'Phòng điều hành', '', '13dbc555-bad6-409c-a9cc-8df58f673a93', NULL, '2023-09-19 08:41:23', NULL, '2023-09-19 08:41:23'),
('b3f1d2c7-8361-4941-8203-6a39216dfbe1', '059995ee-3c07-11ee-b2eb-d8bbc1b19349', 'TS0027', 'Bàn làm việc', 800000.0000, 600000.0000, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'Phòng IT', '25c6c36e-1668-7d10-6e09-bf1378b8dc91', 'Phòng điều hành', '', '13dbc555-bad6-409c-a9cc-8df58f673a93', NULL, NULL, NULL, '2023-09-19 08:40:52');

-- 
-- Dumping data for table receiver
--
INSERT INTO receiver VALUES
('8d89ceea-01b4-4be1-89e3-a9771ca450bc', 1, 'K', 'B', 'C', '13dbc555-bad6-409c-a9cc-8df58f673a93', NULL, '2023-09-19 08:41:23', NULL, '2023-09-19 08:41:23');

-- 
-- Dumping data for table fixedasset
--
INSERT INTO fixedasset VALUES
('0236b916-3c07-11ee-b2eb-d8bbc1b19349', 'TS0026', 'Máy phát điện', NULL, NULL, NULL, '354f1b13-17bf-1b52-87d5-ba100c6f7bce', 'DC115', 'Phòng đào tạo', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2020-08-16 00:00:00', '2020-08-16 00:00:00', 10000000, 2, 10, 2023, 10, 0, NULL, '2023-08-16 14:32:09', NULL, '2023-08-16 14:32:09', NULL),
('059995ee-3c07-11ee-b2eb-d8bbc1b19349', 'TS0027', 'Bàn làm việc', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2021-08-16 00:00:00', '2021-08-16 00:00:00', 800000, 40, 12.5, 2023, 8, 0, NULL, '2023-08-16 14:32:15', NULL, '2023-08-16 14:32:15', NULL),
('0bda0ff1-3be6-11ee-b2eb-d8bbc1b19349', 'TS006', 'Máy phát điện', NULL, NULL, NULL, '354f1b13-17bf-1b52-87d5-ba100c6f7bce', 'DC115', 'Phòng đào tạo', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2020-08-16 00:00:00', '2020-08-16 00:00:00', 10000000, 2, 10, 2023, 10, 0, NULL, NULL, NULL, '2023-08-16 10:43:11', NULL),
('14526409-3bea-11ee-b2eb-d8bbc1b19349', 'TS009', 'Máy chiếu', NULL, NULL, NULL, '354f1b13-17bf-1b52-87d5-ba100c6f7bce', 'DC115', 'Phòng đào tạo', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2020-08-16 00:00:00', '2021-08-16 00:00:00', 8000000, 1, 50, 2023, 2, 0, NULL, NULL, NULL, '2023-08-16 11:05:04', NULL),
('1eb328d1-3c07-11ee-b2eb-d8bbc1b19349', 'TS0028', 'Máy tính để bàn', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2020-08-16 00:00:00', '2020-08-16 00:00:00', 4000000, 40, 16.67, 2023, 6, 0, NULL, '2023-08-16 14:32:57', NULL, '2023-08-16 14:32:57', NULL),
('33b73193-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0015', 'Tivi', NULL, NULL, NULL, '354f1b13-17bf-1b52-87d5-ba100c6f7bce', 'DC115', 'Phòng đào tạo', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2020-08-16 00:00:00', '2020-08-16 00:00:00', 9000000, 1, 10, 2023, 10, 0, NULL, '2023-08-16 13:00:29', NULL, '2023-08-16 13:00:29', NULL),
('3e55700e-3bea-11ee-b2eb-d8bbc1b19349', 'TS0010', 'Máy cắt cỏ', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2021-08-16 00:00:00', '2021-08-16 00:00:00', 4000000, 2, 12.5, 2023, 8, 0, NULL, NULL, NULL, '2023-08-16 11:06:14', NULL),
('3e96000b-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0016', 'Bình cứu hỏa', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2018-08-16 00:00:00', '2018-08-16 00:00:00', 1200000, 4, 10, 2023, 10, 0, NULL, '2023-08-16 13:00:47', NULL, '2023-08-16 13:00:47', NULL),
('420d7973-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0017', 'Ghế sofa', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2018-08-16 00:00:00', '2018-08-16 00:00:00', 16000000, 10, 5, 2023, 20, 0, NULL, '2023-08-16 13:00:53', NULL, '2023-08-16 13:00:53', NULL),
('447f7aa2-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0018', 'Bàn làm việc', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2021-08-16 00:00:00', '2021-08-16 00:00:00', 800000, 40, 12.5, 2023, 8, 0, NULL, '2023-08-16 13:00:57', NULL, '2023-08-16 13:00:57', NULL),
('4668c777-3be9-11ee-b2eb-d8bbc1b19349', 'TS007', 'Bàn làm việc', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2021-08-16 00:00:00', '2021-08-16 00:00:00', 800000, 40, 12.5, 2023, 8, 0, NULL, NULL, NULL, '2023-08-16 10:59:18', NULL),
('4e4b1fe5-3b4c-11ee-b2eb-d8bbc1b19349', 'TS004', 'Máy lọc nước', NULL, NULL, NULL, '25c6c36e-1668-7d10-6e09-bf1378b8dc91', 'DC331', 'Phòng điều hành', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2023-08-15 00:00:00', '2023-08-20 00:00:00', 32161546, 4, 16.67, 2023, 6, 0, NULL, NULL, NULL, '2023-08-15 16:15:41', NULL),
('5187d20c-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0021', 'Bàn làm việc', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2021-08-16 00:00:00', '2021-08-16 00:00:00', 800000, 40, 12.5, 2023, 8, 0, NULL, '2023-08-16 13:01:19', NULL, '2023-08-16 13:01:19', NULL),
('59834312-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0022', 'Máy chiếu', NULL, NULL, NULL, '354f1b13-17bf-1b52-87d5-ba100c6f7bce', 'DC115', 'Phòng đào tạo', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2020-08-16 00:00:00', '2021-08-16 00:00:00', 8000000, 1, 50, 2023, 2, 0, NULL, '2023-08-16 13:01:32', NULL, '2023-08-16 13:01:32', NULL),
('78e593a0-3bfa-11ee-b2eb-d8bbc1b19349', 'TS0023', 'Máy pha cà phê', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2021-08-16 00:00:00', '2022-08-16 00:00:00', 50000000, 2, 25, 2023, 4, 0, NULL, '2023-08-16 13:02:25', NULL, '2023-08-16 13:02:25', NULL),
('7c20c536-3be9-11ee-b2eb-d8bbc1b19349', 'TS008', 'Máy tính để bàn', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2020-08-16 00:00:00', '2020-08-16 00:00:00', 4000000, 40, 16.67, 2023, 6, 0, NULL, NULL, NULL, '2023-08-16 11:00:49', NULL),
('8201b79b-3bf9-11ee-b2eb-d8bbc1b19349', 'TS0013', 'Ghế sofa', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2018-08-16 00:00:00', '2018-08-16 00:00:00', 16000000, 10, 5, 2023, 20, 0, NULL, '2023-08-16 12:55:30', NULL, '2023-08-16 12:55:30', NULL),
('afad18fd-3ab2-11ee-b2eb-d8bbc1b19349', 'TS002', 'Máy nướng bánh', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '6207a9a7-3bf9-7288-8565-390639088226', 'AC03', 'Ngăn chứa', '2023-08-14 00:00:00', '2023-08-14 00:00:00', 1000000, 4, 2.13, 2023, 47, 0, NULL, NULL, NULL, '2023-08-14 21:56:02', NULL),
('b39b3e56-3b79-11ee-b2eb-d8bbc1b19349', 'TS005', 'Máy lọc nước', NULL, NULL, NULL, '25c6c36e-1668-7d10-6e09-bf1378b8dc91', 'DC331', 'Phòng điều hành', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2020-08-15 00:00:00', '2020-08-20 00:00:00', 32161546, 4, 16.67, 2023, 6, 0, NULL, NULL, NULL, '2023-08-15 21:40:38', NULL),
('b8adcfe9-3ab2-11ee-b2eb-d8bbc1b19349', 'TS003', 'Máy nướng bánh', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2023-08-14 00:00:00', '2023-08-14 00:00:00', 1000000, 4, 1.18, 2023, 85, 0, NULL, NULL, NULL, '2023-08-14 21:56:17', NULL),
('b9bc5ddb-3c0f-11ee-b2eb-d8bbc1b19349', 'TS0029', 'Máy nghiền', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2023-08-16 00:00:00', '2023-08-16 00:00:00', 10000000, 2, 5, 2023, 20, 0, NULL, '2023-08-16 15:34:33', NULL, '2023-08-16 15:34:33', NULL),
('c7596368-3bf6-11ee-b2eb-d8bbc1b19349', 'TS0011', 'Máy in', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2020-08-16 00:00:00', '2020-08-16 00:00:00', 14000000, 2, 10, 2023, 10, 0, NULL, NULL, NULL, '2023-08-16 12:35:58', NULL),
('e7852a20-3bf9-11ee-b2eb-d8bbc1b19349', 'TS0014', 'Bình cứu hỏa', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2018-08-16 00:00:00', '2018-08-16 00:00:00', 1200000, 4, 10, 2023, 10, 0, NULL, '2023-08-16 12:58:21', NULL, '2023-08-16 12:58:21', NULL),
('f873e7ba-3bf6-11ee-b2eb-d8bbc1b19349', 'TS0012', 'Ghế đẩu', NULL, NULL, NULL, '148ed882-32b8-218e-9c20-39c2f00615e8', 'DC101', 'Phòng Sale', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2019-08-16 00:00:00', '2019-08-16 00:00:00', 900000, 20, 25, 2023, 4, 0, NULL, NULL, NULL, '2023-08-16 12:37:21', NULL),
('fab4c924-3c06-11ee-b2eb-d8bbc1b19349', 'TS0024', 'Máy cắt cỏ', NULL, NULL, NULL, '3700cc49-55b5-69ea-4929-a2925c0f334d', 'DC902', 'Phòng IT', '60e226cb-63fb-4363-fc4d-8601bf3d85d8', 'AC62', 'Đồ gia dụng', '2021-08-16 00:00:00', '2021-08-16 00:00:00', 4000000, 2, 12.5, 2023, 8, 0, NULL, '2023-08-16 14:31:56', NULL, '2023-08-16 14:31:56', NULL),
('fe57e5ab-3c06-11ee-b2eb-d8bbc1b19349', 'TS0025', 'Máy chiếu', NULL, NULL, NULL, '354f1b13-17bf-1b52-87d5-ba100c6f7bce', 'DC115', 'Phòng đào tạo', '6d81a322-63f0-7270-6d1a-bb545470e80c', 'AC71', 'Dụng cụ kĩ thuật', '2020-08-16 00:00:00', '2021-08-16 00:00:00', 8000000, 1, 50, 2023, 2, 0, NULL, '2023-08-16 14:32:02', NULL, '2023-08-16 14:32:02', NULL);

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

-- 
-- Enable foreign keys
-- 
/*!40014 SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS */;